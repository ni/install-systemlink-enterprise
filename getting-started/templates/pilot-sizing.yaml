# Value overrides for SystemLink pilot resources and replicas.
#
# Use this file in addition to the `systemlink-values.yaml` to
# customize the SystemLink deployment for small pilot clusters.
#
# This file reduces the number of service replicas and pod CPU and
# memory requests such that the application can deploy with fewer
# kubernetes cluster nodes. The cluster is intended to be deployed
# with the following node topology:
# 4 nodes - 8 CPU, 32 GB memory - General node pool
# 2 nodes - 8 CPU, 32 GB memory - Dedicated for Dremio

# Two replicas are used for most services for increased performance.
# The Mongo databases are reduced to a single replica and as a result,
# does not provide any high availability.
#
# This is a YAML-formatted file.

alarmservice:
  resources:
    requests:
      memory: "256Mi"
      cpu: 100m
    limits:
      memory: "512Mi"

  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 60
    targetMemoryUtilizationPercentage: 70

argoworkflows:
  argo-workflows:
    server:
      replicas: 1

assetservice:
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      memory: 512Mi

  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 60
    targetMemoryUtilizationPercentage: 70

  mongodb:
    architecture: replicaset
    replicaCount: 1
    resources:
      requests:
        cpu: 150m
        memory: 512Mi
      limits:
        memory: 1024Mi
    persistence:
      size: 1Gi

assetui:
  resources:
    requests:
      memory: "10Mi"
      cpu: "4m"
    limits:
      memory: "20Mi"

  autoscaling:
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 90

comments:
  resources:
    requests:
      memory: "256Mi"
      cpu: 100m
    limits:
      memory: "512Mi"

  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 60
    targetMemoryUtilizationPercentage: 70

  mongodb:
    architecture: replicaset
    replicaCount: 1
    resources:
      requests:
        cpu: 150m
        memory: 512Mi
      limits:
        memory: 1024Mi
    persistence:
      size: 1Gi

dashboardhost:
  autoscaling:
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 90

  grafana:
    autoscaling:
      minReplicas: 2
      maxReplicas: 2
      metrics:
      - type: Resource
        resource:
          name: cpu
          targetAverageUtilization: 80
      - type: Resource
        resource:
          name: memory
          targetAverageUtilization: 90

dashboardsui:
  resources:
    requests:
      memory: "10Mi"
      cpu: "4m"
    limits:
      memory: "20Mi"

  autoscaling:
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 90

dataframeservice:
  resources:
    requests:
      memory: 512Mi
      cpu: 100m
    limits:
      memory: 512Mi

  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 60
    targetMemoryUtilizationPercentage: 70

  mongodb:
    architecture: replicaset
    replicaCount: 1
    resources:
      requests:
        cpu: "150m"
        memory: "256Mi"
      limits:
        memory: "256Mi"

executionsui:
  resources:
    requests:
      memory: "10Mi"
      cpu: "4m"
    limits:
      memory: "20Mi"

  autoscaling:
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 90

feedservice:
  resources:
    requests:
      memory: "256Mi"
      cpu: 100m
    limits:
      memory: "512Mi"

  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 60
    targetMemoryUtilizationPercentage: 70

  mongodb:
    architecture: replicaset
    replicaCount: 1
    resources:
      requests:
        cpu: 150m
        memory: 512Mi
      limits:
        memory: 1024Mi
    persistence:
      size: 1Gi

fileingestion:
  resources:
    requests:
      memory: "128Mi"
      cpu: "50m"
    limits:
      memory: "256Mi"

  autoscaling:
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 90

  mongodb:
    architecture: replicaset
    replicaCount: 1
    resources:
      requests:
        cpu: 150m
        memory: 256Mi
      limits:
        memory: 1024Mi
    persistence:
      size: 1Gi

filesui:
  resources:
    requests:
      memory: "10Mi"
      cpu: "4m"
    limits:
      memory: "20Mi"

  autoscaling:
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 90

landingpageui:
  resources:
    requests:
      memory: "10Mi"
      cpu: "4m"
    limits:
      memory: "20Mi"

  autoscaling:
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 90

minio:
  persistence:
    size: 1Gi
  provisioning:
    enabled: true
    buckets:
      - name: "systemlink-file-ingestion"
        region: "us-east-1"
        versioning: false
        withLock: false
      - name: "systemlink-dataframe"
        region: "us-east-1"
        versioning: false
        withLock: false
  resources:
    requests:
      memory: "256Mi"
      cpu: "50m"
    limits:
      memory: "512Mi"

nbexecservice:
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"

  autoscaling:
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 90

  mongodb:
    architecture: replicaset
    replicaCount: 1
    resources:
      requests:
        cpu: 150m
        memory: 256Mi
      limits:
        memory: 1024Mi
    persistence:
      size: 1Gi

nbparsingservice:
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"

  autoscaling:
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 90

notification:
  resources:
    requests:
      memory: "256Mi"
      cpu: 100m
    limits:
      memory: "512Mi"

  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 60
    targetMemoryUtilizationPercentage: 70

  mongodb:
    architecture: replicaset
    replicaCount: 1
    resources:
      requests:
        cpu: 150m
        memory: 512Mi
      limits:
        memory: 1024Mi
    persistence:
      size: 1Gi

rabbitmq:
  resources:
    requests:
      cpu: "100m"
      memory: "256Mi"
    limits:
      memory: "512Mi"

repository:
  resources:
    requests:
      memory: "256Mi"
      cpu: 100m
    limits:
      memory: "512Mi"

  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 60
    targetMemoryUtilizationPercentage: 70

  mongodb:
    architecture: replicaset
    replicaCount: 1
    resources:
      requests:
        cpu: 150m
        memory: 512Mi
      limits:
        memory: 1024Mi
    persistence:
      size: 1Gi

routineeventtrigger:
  resources:
    requests:
      memory: "256Mi"
      cpu: 100m
    limits:
      memory: "512Mi"

  replicaCount: 1

routineexecutor:
  resources:
    requests:
      memory: "256Mi"
      cpu: 100m
    limits:
      memory: "512Mi"

  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 60
    targetMemoryUtilizationPercentage: 70

routinescheduletrigger:
  resources:
    requests:
      memory: "256Mi"
      cpu: 100m
    limits:
      memory: "512Mi"

  replicaCount: 1

  mongodb:
    architecture: replicaset
    replicaCount: 1
    resources:
      requests:
        cpu: 150m
        memory: 512Mi
      limits:
        memory: 1024Mi
    persistence:
      size: 1Gi

routineservice:
  resources:
    requests:
      memory: "128Mi"
      cpu: "50m"
    limits:
      memory: "256Mi"

  autoscaling:
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 90

  mongodb:
    architecture: replicaset
    replicaCount: 1
    resources:
      requests:
        cpu: 150m
        memory: 256Mi
      limits:
        memory: 1024Mi
    persistence:
      size: 1Gi

  engine:
    replicaCount: 1
    resources:
      requests:
        memory: "25Mi"
        cpu: "4m"
      limits:
        memory: "50Mi"

routinesui:
  resources:
    requests:
      memory: "10Mi"
      cpu: "4m"
    limits:
      memory: "20Mi"

  autoscaling:
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 90

saltmaster:
  resources:
    requests:
      memory: "256Mi"
      cpu: 100m
    limits:
      memory: "512Mi"

  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 60
    targetMemoryUtilizationPercentage: 70

  mongodb:
    architecture: replicaset
    replicaCount: 1
    resources:
      requests:
        cpu: 150m
        memory: 512Mi
      limits:
        memory: 1024Mi
    persistence:
      size: 1Gi

securityui:
  resources:
    requests:
      memory: "10Mi"
      cpu: "4m"
    limits:
      memory: "20Mi"

  autoscaling:
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 90

serviceregistry:
  resources:
    requests:
      memory: "256Mi"
      cpu: "50m"
    limits:
      memory: "256Mi"

  autoscaling:
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 90

sessionmanager:
  resources:
    requests:
      memory: "64Mi"
      cpu: "50m"
    limits:
      memory: "128Mi"

  autoscaling:
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 90

sl-jupyterhub:
  jupyterhub:
    hub:
      resources:
        requests:
          memory: "128Mi"
          cpu: "100m"
        limits:
          memory: "256Mi"

smtp:
  resources:
    requests:
      memory: "256Mi"
      cpu: 100m
    limits:
      memory: "512Mi"

  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 60
    targetMemoryUtilizationPercentage: 70

swaggerapi:
  resources:
    requests:
      memory: "256Mi"
      cpu: 100m
    limits:
      memory: "512Mi"

  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 60
    targetMemoryUtilizationPercentage: 70

sysmgmtevent:
  resources:
    requests:
      memory: "256Mi"
      cpu: 100m
    limits:
      memory: "512Mi"

  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 60
    targetMemoryUtilizationPercentage: 70

  mongodb:
    architecture: replicaset
    replicaCount: 1
    resources:
      requests:
        cpu: 150m
        memory: 512Mi
      limits:
        memory: 1024Mi
    persistence:
      size: 1Gi

systems:
  resources:
    requests:
      memory: "128Mi"
      cpu: "50m"
    limits:
      memory: "256Mi"

  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 2

  mongodb:
    architecture: replicaset
    replicaCount: 1
    resources:
      requests:
        cpu: 150m
        memory: 256Mi
      limits:
        memory: 1024Mi
    persistence:
      size: 1Gi

systemsstate:
  resources:
    requests:
      memory: "256Mi"
      cpu: 100m
    limits:
      memory: "512Mi"

  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 60
    targetMemoryUtilizationPercentage: 70

systemsui:
  resources:
    requests:
      memory: "10Mi"
      cpu: "4m"
    limits:
      memory: "20Mi"

  autoscaling:
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 90

tags:
  resources:
    requests:
      memory: "256Mi"
      cpu: 100m
    limits:
      memory: "512Mi"

  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 60
    targetMemoryUtilizationPercentage: 70

  mongodb:
    architecture: replicaset
    replicaCount: 1
    resources:
      requests:
        cpu: 150m
        memory: 512Mi
      limits:
        memory: 1024Mi
    persistence:
      size: 1Gi

taghistorian:
  resources:
    requests:
      memory: "256Mi"
      cpu: 100m
    limits:
      memory: "512Mi"

  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 60
    targetMemoryUtilizationPercentage: 70

  mongodb:
    architecture: replicaset
    replicaCount: 1
    resources:
      requests:
        cpu: 150m
        memory: 512Mi
      limits:
        memory: 1024Mi
    persistence:
      size: 1Gi

  dataRetention:
    resources:
      requests:
        memory: "256Mi"
        cpu: 100m
      limits:
        memory: "512Mi"

    autoscaling:
      enabled: true
      minReplicas: 2
      maxReplicas: 2
      targetCPUUtilizationPercentage: 60
      targetMemoryUtilizationPercentage: 70

testinsightsui:
  resources:
    requests:
      memory: "10Mi"
      cpu: "4m"
    limits:
      memory: "20Mi"

  autoscaling:
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 90

testmonitorservice:
  resources:
    requests:
      memory: "256Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"

  autoscaling:
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 90

userdata:
  resources:
    requests:
      memory: "64Mi"
      cpu: "25m"
    limits:
      memory: "128Mi"

  autoscaling:
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 90

  mongodb:
    architecture: replicaset
    replicaCount: 1
    resources:
      requests:
        cpu: 150m
        memory: 256Mi
      limits:
        memory: 1024Mi
    persistence:
      size: 1Gi

userservices:
  resources:
    requests:
      memory: "64Mi"
      cpu: "50m"
    limits:
      memory: "128Mi"

  autoscaling:
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 90

  mongodb:
    architecture: replicaset
    replicaCount: 1
    resources:
      requests:
        cpu: 150m
        memory: 256Mi
      limits:
        memory: 1024Mi
    persistence:
      size: 1Gi

webappservices:
  resources:
    requests:
      memory: "64Mi"
      cpu: "50m"
    limits:
      memory: "128Mi"

  autoscaling:
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 90

  mongodb:
    architecture: replicaset
    replicaCount: 1
    resources:
      requests:
        cpu: 150m
        memory: 256Mi
      limits:
        memory: 1024Mi
    persistence:
      size: 1Gi

webserver:
  resources:
    requests:
      memory: "128Mi"
      cpu: "50m"
    limits:
      memory: "256Mi"

  autoscaling:
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 80
    targetMemoryUtilizationPercentage: 90

  redis-cluster:
    cluster:
      nodes: 3
      replicas: 0
    redis:
      resources:
        requests:
          cpu: 50m
        limits:

workorder:
  resources:
    requests:
      memory: "256Mi"
      cpu: 100m
    limits:
      memory: "512Mi"

  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 2
    targetCPUUtilizationPercentage: 60
    targetMemoryUtilizationPercentage: 70

  mongodb:
    architecture: replicaset
    replicaCount: 1
    resources:
      requests:
        cpu: 150m
        memory: 512Mi
      limits:
        memory: 1024Mi
    persistence:
      size: 1Gi
